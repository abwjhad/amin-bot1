import telebot
import sqlite3
import requests
import time
import os
import threading
import html
import random

# ==========================================
# âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
# ==========================================
TOKEN = "6396872015:AAHQCVV0NKKAUx0jw4Un3e6YcuUGU19jd1M"
GEMINI_KEY = "AIzaSyABXhnU1tRmhuuL9FyRAtY-qGRdtQr-xiE"
ADMIN_ID = 5509592307
MAIN_CHANNEL = "@Yemen_International_Library"
LIB_LINK = "https://t.me/Yemen_International_Library"

bot = telebot.TeleBot(TOKEN)
db_path = "billion_lib.db"

# ==========================================
# ğŸ­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ 50 Ø£Ø³Ù„ÙˆØ¨Ø§Ù‹ Ø§Ù„Ù…Ø¨ØªÙƒØ±Ø© (ØªÙ… Ø¯Ù…Ø¬Ù‡Ø§ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„)
# ==========================================
PROMPT_STYLES = [
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ø§Ù„Ù… Ø£Ù†Ø«Ø±ÙˆØ¨ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø«Ù‚Ø§ÙÙŠØ© ÙŠØ­Ù„Ù„ Ø§Ù„ÙƒØªØ§Ø¨ ÙƒØ¸Ø§Ù‡Ø±Ø© Ù…Ø¬ØªÙ…Ø¹ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø®ØªØ±Ø¹ Ø¹Ø¨Ù‚Ø±ÙŠ ÙŠØ±Ù‰ ÙÙŠ Ø£ÙÙƒØ§Ø± Ø§Ù„ÙƒØªØ§Ø¨ Ø¢Ù„ÙŠØ§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØµÙ†ÙŠØ¹.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø±Ø­Ø§Ù„Ø© Ù…Ø³ØªÙƒØ´Ù ÙŠØ¹ØªØ¨Ø± Ø§Ù„ÙƒØªØ§Ø¨ Ø®Ø±ÙŠØ·Ø© Ù„Ø£Ø±Ø§Ø¶Ù Ù„Ù… ØªØ·Ø£Ù‡Ø§ Ù‚Ø¯Ù….",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù‚Ø§Ø¦Ø¯ Ø¹Ø³ÙƒØ±ÙŠ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ ÙŠØ¶Ø¹ Ø®Ø·Ø·Ù‹Ø§ Ù„Ù„Ù‡Ø¬ÙˆÙ… ÙˆØ§Ù„Ø¯ÙØ§Ø¹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ØµÙˆØµÙ‡.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø­Ø§Ù…Ù Ù‚Ø¶Ø§Ø¦ÙŠ ÙŠØ³ØªØ¯Ù„ Ø¨Ù†ØµÙˆØµ Ø§Ù„ÙƒØªØ§Ø¨ ÙƒØ£Ø¯Ù„Ø© ÙÙŠ Ù‚Ø¶ÙŠØ© ÙƒØ¨Ø±Ù‰.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø·Ø¨ÙŠØ¨ Ù†ÙØ³ÙŠ Ø³Ø±ÙŠØ±ÙŠ ÙŠØ´Ø®Øµ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ§Øª ÙˆÙŠØ¯ÙˆÙ† Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙ‡.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø®Ø¨ÙŠØ± Ø§Ù‚ØªØµØ§Ø¯ÙŠ ÙŠÙ‚ÙŠØ³ Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ù…Ø¹Ø±ÙÙŠ Ù…Ù† Ù‚Ø±Ø§Ø¡ØªÙ‡.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…ØµÙ…Ù… Ø£Ø²ÙŠØ§Ø¡ ÙŠØµÙ Ø«ÙŠØ§Ø¨ Ø§Ù„Ø£ÙÙƒØ§Ø± ÙˆØ£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø§Ø¹Ø± ÙÙŠ Ø§Ù„Ù†Øµ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ ÙÙ†Ø§Ù† ØªØ´ÙƒÙŠÙ„ÙŠ ÙŠØªØ­Ø¯Ø« Ø¹Ù† Ø§Ù„ÙƒØªØ§Ø¨ ÙƒÙ„ÙˆØ­Ø© ØªØ¬Ø±ÙŠØ¯ÙŠØ© Ø¹Ø¸ÙŠÙ…Ø©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ø§Ø²Ù Ù…ÙˆØ³ÙŠÙ‚Ù‰ ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ ÙŠØ³Ù…Ø¹ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ø¹ Ø§Ù„Ø®ÙÙŠ Ù„Ø¬Ù…Ù„ Ø§Ù„ÙƒØªØ§Ø¨.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø¹Ù…Ø§Ø±ÙŠ ÙŠØ¨Ù†ÙŠ Ù‚ØµØ±Ù‹Ø§ Ù…Ù† Ø£ÙÙƒØ§Ø±Ù‡ ÙˆÙŠØ±ØµÙ Ø·Ø±Ù‚ Ø§Ø³ØªÙ†ØªØ§Ø¬Ø§ØªÙ‡.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ø§Ù„Ù… ÙÙŠØ²ÙŠØ§Ø¡ ÙÙ„ÙƒÙŠØ© ÙŠØ±Ù‰ Ø§Ù„ÙƒØªØ§Ø¨ ÙƒÙ…Ø¬Ø±Ø© ØªØ­ØªÙˆÙŠ Ø«Ù‚ÙˆØ¨Ù‹Ø§ Ø³ÙˆØ¯Ø§Ø¡ Ù…Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø±.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø®Ø¨ÙŠØ± ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© ÙŠØªÙ†Ø¨Ø£ Ø¨Ù…ØµÙŠØ± Ø£ÙÙƒØ§Ø± Ø§Ù„ÙƒØªØ§Ø¨ ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø¢Ù„Ø©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø­ÙƒÙŠÙ… Ø´Ø±Ù‚ÙŠ ÙŠØ³ØªØ®Ø¯Ù… Ø£Ù…Ø«Ø§Ù„Ø§Ù‹ Ù‚Ø¯ÙŠÙ…Ø© Ù„ÙÙƒ Ø´ÙØ±Ø§Øª Ø§Ù„Ù†Øµ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø±Ø³Ø§Ù… ÙƒØ§Ø±ÙŠÙƒØ§ØªÙŠØ± Ø³Ø§Ø®Ø± ÙŠÙ„ØªÙ‚Ø· Ù…ÙØ§Ø±Ù‚Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨ Ø¨Ø®Ø·ÙˆØ· Ø¨Ø³ÙŠØ·Ø©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø±Ø§Ø¦Ø¯ ÙØ¶Ø§Ø¡ ÙŠØµÙ Ø§Ù„ØªØ¬Ø±Ø¨Ø© ÙƒÙ…Ø§ Ù„Ùˆ ÙƒØ§Ù†Øª Ø³ÙŠØ±Ù‡ ÙÙŠ ÙØ¶Ø§Ø¡ Ø§Ù„Ù†Øµ Ø§Ù„Ù„Ø§ Ù…ØªÙ†Ø§Ù‡ÙŠ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ø§Ù„Ù… ÙƒÙŠÙ…ÙŠØ§Ø¡ ÙŠØ­ÙˆÙ„ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØªÙØ§Ø¹Ù„Ø§Øª Ø¹Ø§Ø·ÙÙŠØ© ÙˆÙÙƒØ±ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù„Ø§Ø¹Ø¨ Ø´Ø·Ø±Ù†Ø¬ Ù…Ø­ØªØ±Ù ÙŠØ®Ø·Ø· Ù„ØªØ­Ø±ÙƒØ§ØªÙ‡ Ø§Ù„ÙÙƒØ±ÙŠØ© Ø¶Ù…Ù† Ø±Ù‚Ø¹Ø© Ø§Ù„ÙƒØªØ§Ø¨.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¨Ø³ØªØ§Ù†ÙŠ Ù…Ø§Ù‡Ø± ÙŠØªØ­Ø¯Ø« Ø¹Ù† Ø²Ø±Ø§Ø¹Ø© Ø¨Ø°ÙˆØ± Ø§Ù„Ø£ÙÙƒØ§Ø± ÙˆØ±ÙŠÙ‘Ù‡Ø§.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø·Ø§Ù‡Ù Ø°ÙˆØ§Ù‚Ø© ÙŠØµÙ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨ ÙˆÙˆØµÙØ© Ø®Ù„Ø·Ù‡ Ø§Ù„ÙØ±ÙŠØ¯Ø©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…ØªØ±Ø¬Ù… Ø´ÙÙˆÙŠ Ø¨ÙŠÙ† Ø§Ù„Ù„ØºØ§Øª ÙˆØ§Ù„Ø«Ù‚Ø§ÙØ§ØªØŒ ÙŠØ¬Ø³Ø± Ù‡ÙˆØ© Ø§Ù„Ù‚Ø§Ø±Ø¦ ÙˆØ§Ù„Ù†Øµ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…ØªØ³Ù„Ù‚ Ø¬Ø¨Ø§Ù„ ÙŠØµÙ Ø§Ù„ØªØ­Ø¯ÙŠ ÙˆØ§Ù„ØµØ¹ÙˆØ¯ Ø¥Ù„Ù‰ Ù‚Ù…Ù… Ø§Ù„Ø¥Ø¯Ø±Ø§Ùƒ ÙÙŠ Ø§Ù„ÙƒØªØ§Ø¨.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ ØµØ§Ø¦Øº Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª ÙŠØªØ­Ø¯Ø« Ø¹Ù† ØµÙ‚Ù„ Ø§Ù„Ø¬Ù…Ù„ ÙˆØªÙ„Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù†ÙŠ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø±Ø´Ø¯ Ø³ÙŠØ§Ø­ÙŠ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø¹ØªÙŠÙ‚Ø©ØŒ ÙŠØ´Ø±Ø­ Ù…Ø¹Ø§Ù„Ù…Ù‡Ø§.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ø§Ù„Ù… Ø±ÙŠØ§Ø¶ÙŠØ§Øª ÙŠØ¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª ÙˆØ§Ù„ØªÙ†Ø§Ø³Ù‚Ø§Øª Ø§Ù„Ø®ÙÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ø³Ø·ÙˆØ±.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø±Ø¬Ù„ Ø£Ø¹Ù…Ø§Ù„ ÙŠÙ†Ø´Ø¦ Ù…Ø´Ø±ÙˆØ¹Ù‹Ø§ Ù…Ø±Ø¨Ø­Ù‹Ø§ Ù…Ù† Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø§Ù„ÙÙƒØ±ÙŠ Ù„Ù„ÙƒØªØ§Ø¨.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ù…Ø«Ù„ Ù…Ø³Ø±Ø­ÙŠ ÙŠØ¤Ø¯Ù‘ÙŠ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ§Øª Ø¨Ø£ØµÙˆØ§Øª Ù…Ø®ØªÙ„ÙØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø­Ù‚Ù‚ Ø¨ÙˆÙ„ÙŠØ³ÙŠ ÙŠØ¬Ù…Ø¹ Ø£Ø¯Ù„Ø© Ù„Ø­Ù„ Ù„ØºØ² Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø±Ø§Ù‚Øµ Ø¨Ø§Ù„ÙŠÙ‡ ÙŠØªØ±Ø¬Ù… Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø­Ø±ÙƒØ§Øª Ø§Ù†Ø³ÙŠØ§Ø¨ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ ØµØ§Ù†Ø¹ Ø³Ø§Ø¹Ø§Øª Ø¯Ù‚ÙŠÙ‚Ø© ÙŠØ­Ù„Ù„ Ø²Ù…Ù† Ø§Ù„Ù†Øµ ÙˆØªÙˆÙ‚ÙŠØªØ§ØªÙ‡ Ø§Ù„Ù†ÙØ³ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¬ÙŠÙˆÙ„ÙˆØ¬ÙŠ ÙŠÙ‚Ø·Ø¹ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ù†Øµ Ù„ÙŠÙƒØ´Ù Ø¹Ù† Ø¹ØµÙˆØ±Ù‡ Ø§Ù„Ù…ØªØ¹Ø§Ù‚Ø¨Ø©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù‚Ø§Ø¶ÙŠ Ø´Ø±Ø¹ÙŠ ÙŠØ³ØªÙ†Ø¨Ø· Ø§Ù„Ø£Ø­ÙƒØ§Ù… ÙˆØ§Ù„Ø£ÙˆØ§Ù…Ø± ÙˆØ§Ù„Ù†ÙˆØ§Ù‡ÙŠ Ø§Ù„Ø£Ø¯Ø¨ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø®Ø±Ø¬ Ù…Ø³Ø±Ø­ÙŠ Ø·Ù„ÙŠØ¹ÙŠ ÙŠØ¹Ø¯Ù‘ Ù…Ø´Ù‡Ø¯ÙŠØ© Ø§Ù„ÙƒØªØ§Ø¨ ÙƒØ¹Ø±Ø¶ ØºÙŠØ± ØªÙ‚Ù„ÙŠØ¯ÙŠ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø­Ø±ÙÙŠ ÙŠØ¯ÙˆÙŠ ÙŠØµÙ†Ø¹ ØªØ­ÙØ© ÙÙ†ÙŠØ© Ù…Ù† Ø®Ø§Ù…Ø§Øª Ø§Ù„ÙƒÙ„Ù…Ø§Øª.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ø§Ù„Ù… Ø£Ø­ÙŠØ§Ø¡ Ø¨Ø­Ø±ÙŠØ© ÙŠØºÙˆØµ ÙÙŠ Ø£Ø¹Ù…Ø§Ù‚ Ø§Ù„ÙƒØªØ§Ø¨ Ù„Ø§ÙƒØªØ´Ø§Ù ÙƒØ§Ø¦Ù†Ø§ØªÙ‡ Ø§Ù„Ù†Ø§Ø¯Ø±Ø©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…ØªØ­Ø¯Ø« ØªØ­ÙÙŠØ²ÙŠ (Ù…ÙˆØ¯ÙŠÙÙŠØ´ÙˆÙ†Ø§Ù„) ÙŠØ­ÙˆÙ„ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø¥Ù„Ù‰ Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ù…Ø§Ø³ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø®ØªØµ ÙÙŠ Ø¹Ù„Ù… Ø§Ù„Ø£Ø­Ù„Ø§Ù… (ÙˆÙ†ÙŠÙˆØ±ÙˆÙ„ÙˆØ¬ÙŠ) ÙŠØ­Ù„Ù„ Ø±Ù…ÙˆØ² Ø§Ù„ÙƒØªØ§Ø¨ ÙƒØ±Ù…ÙˆØ² Ø­Ù„Ù…ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¯ÙŠ Ø¬ÙŠ (DJ) ÙŠØ®Ù„Ø· Ù…Ù‚Ø§Ø·Ø¹ Ù…Ù† Ø§Ù„ÙƒØªØ§Ø¨ Ù„ÙŠØ®Ù„Ù‚ Ù…Ù‚Ø·ÙˆØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø±Ø§ØµØ¯ Ø·Ù‚Ø³ ÙŠØªÙ†Ø¨Ø£ Ø¨Ø§Ù„Ù…Ù†Ø§Ø® Ø§Ù„Ø¹Ø§Ø·ÙÙŠ ÙˆØ§Ù„ÙÙƒØ±ÙŠ Ù„Ù„ÙƒØªØ§Ø¨.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø³Ø§Ø­Ø± Ù‚Ø¯ÙŠÙ… ÙŠØªÙ„Ùˆ ØªØ¹ÙˆÙŠØ°Ø§Øª Ù…Ù† Ø¬Ù…Ù„ Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø³Ø­Ø±ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…ØµÙˆØ± ÙÙˆØªÙˆØºØ±Ø§ÙÙŠ ÙŠÙ„ØªÙ‚Ø· Ù„Ù‚Ø·Ø§Øª Ù…Ø¶ÙŠØ¦Ø© Ù…Ù† Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ Ø§Ù„Ù†ØµÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø³Ø§Ø¹ÙŠ Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø²Ù…Ù† Ø§Ù„Ù‚Ø¯ÙŠÙ…ØŒ ÙŠÙ‚Ø¯Ù… Ø§Ù„ÙƒØªØ§Ø¨ ÙƒØ±Ø³Ø§Ù„Ø© ÙˆØµÙ„Øª Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ø¨Ø±Ù…Ø¬ Ø­Ø§Ø³ÙˆØ¨ ÙŠÙƒØªØ¨ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ù„ÙÙƒ ØªØ´ÙÙŠØ± Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙƒØªØ§Ø¨.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù†Ø§Ø³Ø® Ù…Ø®Ø·ÙˆØ·Ø§Øª Ù‚Ø¯ÙŠÙ… ÙŠØªØ­Ø¯Ø« Ø¹Ù† Ø¬Ù…Ø§Ù„ Ø§Ù„Ø­Ø±Ù ÙˆØ«Ù…Ù† Ø§Ù„Ù†Øµ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ø§Ù„Ù… Ø¢Ø«Ø§Ø± ÙŠÙ†Ù‚Ø¨ ÙÙŠ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨ Ø¹Ù† Ø¢Ø«Ø§Ø± Ø§Ù„Ø­Ø¶Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø·ÙŠØ§Ø± ÙŠÙ‚ÙˆØ¯ Ø§Ù„Ù‚Ø§Ø±Ø¦ ÙÙŠ Ø±Ø­Ù„Ø© Ø¬ÙˆÙŠØ© ÙÙˆÙ‚ ØªØ¶Ø§Ø±ÙŠØ³ Ø§Ù„Ù†Øµ.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø®Ø¨ÙŠØ± ØªØ³ÙˆÙŠÙ‚ Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ ÙŠØ¹Ù„Ù† Ø¹Ù† Ø§Ù„ÙƒØªØ§Ø¨ ÙƒÙ…Ù†ØªØ¬ Ù„Ø§ ØºÙ†Ù‰ Ø¹Ù†Ù‡.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ ØµØ¯ÙŠÙ‚ Ø­Ù…ÙŠÙ… ÙŠÙ‡Ù…Ø³ Ø¨Ø§Ù†Ø·Ø¨Ø§Ø¹Ø§ØªÙ‡ Ø¹Ù† Ø§Ù„ÙƒØªØ§Ø¨ Ø¨ØµØ±Ø§Ø­Ø© ÙˆØ¯ÙØ¡.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªÙ‚Ø¯Ù… ÙŠØ­Ù„Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†ØµÙŠØ© ÙˆÙŠÙˆÙ„Ø¯ Ø±Ø¤Ù‰ Ù…ÙˆØ¶ÙˆØ¹ÙŠØ©.",
    "Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø¬Ø¯Ø© Ø§Ù„Ø­ÙƒÙŠÙ…Ø© ØªØ±ÙˆÙŠ Ø­ÙƒØ§ÙŠØ© Ø§Ù„ÙƒØªØ§Ø¨ Ø¹Ù„Ù‰ Ø¶ÙˆØ¡ Ø§Ù„Ù…ØµØ¨Ø§Ø­."
]

# ==========================================
# ğŸ§  Ù…Ø­Ø±Ùƒ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…ØªÙ†ÙˆØ¹ (Gemini 1.5 Flash)
# ==========================================
def get_ai_response(book_name):
    selected_style = random.choice(PROMPT_STYLES)
    url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key={GEMINI_KEY}"
    
    prompt = (
        f"Ø£Ø±ÙŠØ¯Ùƒ Ø£Ù† ØªÙƒØªØ¨ {selected_style}\n"
        f"Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ÙƒØªØ§Ø¨ Ø¨Ø¹Ù†ÙˆØ§Ù† '{book_name}'.\n"
        f"Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: \n"
        f"1. Ø§Ù„ØªØµÙ†ÙŠÙ (Ø¯Ù‚ÙŠÙ‚ ÙˆÙ…Ø¨ØªÙƒØ±).\n"
        f"2. Ø§Ù„Ù†Ø¨Ø°Ø© (ÙˆØµÙ Ø¨Ù„ÙŠØº ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ù…Ø®ØªØ§Ø±).\n"
        f"3. Ø§Ù„Ø¯Ø±Ø± (Ø§Ù‚ØªØ¨Ø§Ø³ Ø£Ùˆ Ø­ÙƒÙ…Ø© Ø¨Ù„ÙŠØºØ© Ù…Ù† Ø±ÙˆØ­ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨).\n\n"
        f"Ø§ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø¨Ù€ | ÙÙ‚Ø·. Ù„Ø§ ØªØ°ÙƒØ± Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨ ÙÙŠ Ø§Ù„ÙˆØµÙ."
    )
    
    try:
        res = requests.post(url, json={"contents": [{"parts": [{"text": prompt}]}]}, timeout=20).json()
        output = res['candidates'][0]['content']['parts'][0]['text']
        parts = output.split('|')
        return {
            "cat": html.escape(parts[0].strip()) if len(parts)>0 else "Ù…Ø¹Ø±ÙØ©",
            "desc": html.escape(parts[1].strip()) if len(parts)>1 else "Ø¥Ø¶Ø§ÙØ© Ù†ÙˆØ¹ÙŠØ© Ù„Ù„Ù…ÙƒØªØ¨Ø©.",
            "wisdom": html.escape(parts[2].strip()) if len(parts)>2 else "Ø§Ù„Ø¹Ù„Ù… Ù†ÙˆØ±.",
            "style": selected_style
        }
    except:
        return {"cat": "Ø«Ù‚Ø§ÙØ©", "desc": "ÙƒØªØ§Ø¨ Ù‚ÙŠÙ… ÙŠØ³ØªØ­Ù‚ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©.", "wisdom": "Ø§Ù‚Ø±Ø£ Ù„ØªØ±Ù‚Ù‰.", "style": "Ø£Ø³Ù„ÙˆØ¨ Ø§ÙØªØ±Ø§Ø¶ÙŠ"}

# ==========================================
# âš™ï¸ Ù…Ø­Ø±Ùƒ Ø§Ù„Ù†Ø´Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ (Ø§Ù„Ø±Ø§Ø¯Ø§Ø±)
# ==========================================
def publisher_loop():
    conn = sqlite3.connect(db_path, check_same_thread=False)
    conn.execute('CREATE TABLE IF NOT EXISTS files (hash TEXT PRIMARY KEY, name TEXT, file_id TEXT, status TEXT)')
    conn.commit()
    
    while True:
        try:
            cur = conn.cursor()
            cur.execute("SELECT hash, name, file_id FROM files WHERE status='pending' LIMIT 1")
            task = cur.fetchone()
            
            if task:
                f_hash, f_name, f_id = task
                clean_name = f_name.replace('.pdf','').replace('_',' ').strip()
                
                # Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                ai = get_ai_response(clean_name)
                
                caption = (
                    f"ğŸ“š <b>{clean_name}</b>\n\n"
                    f"ğŸ“‚ <b>Ø§Ù„ØªØµÙ†ÙŠÙ:</b> {ai['cat']}\n"
                    f"ğŸ“ <b>Ø¹Ù† Ø§Ù„ÙƒØªØ§Ø¨:</b> {ai['desc']}\n"
                    f"ğŸ’¡ <b>Ø¯Ø±Ø±:</b> <i>{ai['wisdom']}</i>\n\n"
                    f"ğŸ­ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨: {ai['style']}\n"
                    f"ğŸ›ï¸ <a href='{LIB_LINK}'>Ø§Ù†Ø¶Ù… Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù„ÙŠØ§Ø± ÙƒØªØ§Ø¨</a>"
                )

                try:
                    bot.send_document(MAIN_CHANNEL, f_id, caption=caption, parse_mode="HTML")
                    cur.execute("UPDATE files SET status='published' WHERE hash=?", (f_hash,))
                    conn.commit()
                    
                    # Ø¥Ø´Ø¹Ø§Ø± Ù†Ø¬Ø§Ø­ Ù„Ù„Ø£Ø¯Ù…Ù†
                    bot.send_message(ADMIN_ID, f"âœ… <b>ØªÙ… Ø§Ù„Ù†Ø´Ø±:</b> {clean_name}\nğŸ­ <b>Ø¨Ø§Ù„Ø£Ø³Ù„ÙˆØ¨:</b> {ai['style']}", parse_mode="HTML")
                    time.sleep(20)
                except Exception as e:
                    bot.send_message(ADMIN_ID, f"âŒ ÙØ´Ù„ Ù†Ø´Ø± {clean_name}\nØ§Ù„Ø³Ø¨Ø¨: {html.escape(str(e))}")
                    cur.execute("UPDATE files SET status='failed' WHERE hash=?", (f_hash,))
                    conn.commit()
            else:
                time.sleep(15)
        except Exception as e:
            print(f"Error: {e}")
            time.sleep(10)

# ==========================================
# ğŸ“¥ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙˆØ¬Ø¯ÙˆÙ„Ø© Ø§Ù„ÙƒØªØ¨
# ==========================================
@bot.message_handler(content_types=['document', 'video', 'audio'])
def handle_docs(message):
    if message.from_user.id != ADMIN_ID: return
    try:
        f = message.document or message.video or message.audio
        name = getattr(f, 'file_name', "ÙƒØªØ§Ø¨_Ø¬Ø¯ÙŠØ¯")
        h = f"{name}_{f.file_size}"
        
        conn = sqlite3.connect(db_path)
        conn.execute("INSERT OR IGNORE INTO files VALUES (?, ?, ?, ?)", (h, name, f.file_id, 'pending'))
        conn.commit()
        conn.close()
        
        bot.reply_to(message, "âœ… ØªÙ…Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© Ø¨Ù†Ø¬Ø§Ø­. Ø³Ø£Ø®ØªØ§Ø± Ø£Ø³Ù„ÙˆØ¨Ø§Ù‹ Ù…Ù† Ø§Ù„Ù€ 50 Ø£Ø³Ù„ÙˆØ¨Ø§Ù‹ Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù†Ø´Ø±Ù‡ Ù‚Ø±ÙŠØ¨Ø§Ù‹.")
    except: pass

@bot.message_handler(commands=['status'])
def status(message):
    if message.from_user.id != ADMIN_ID: return
    conn = sqlite3.connect(db_path)
    p = conn.execute("SELECT COUNT(*) FROM files WHERE status='pending'").fetchone()[0]
    s = conn.execute("SELECT COUNT(*) FROM files WHERE status='published'").fetchone()[0]
    conn.close()
    bot.reply_to(message, f"ğŸ“Š <b>Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø©:</b>\nâ³ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±: {p}\nâœ… Ø§Ù„Ù…Ù†Ø´ÙˆØ±: {s}\nğŸ­ Ø§Ù„Ø£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ù†Ø´Ø·Ø©: 50 Ø£Ø³Ù„ÙˆØ¨Ø§Ù‹", parse_mode="HTML")

if __name__ == "__main__":
    threading.Thread(target=publisher_loop, daemon=True).start()
    print("ğŸ¤– Ø§Ù„Ø¨ÙˆØª ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† Ø¨Ø§Ù„Ø£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ù€ 50...")
    bot.infinity_polling()
